# Template for MCP ABAP ADT test configuration
# Copy this file to test-config.yaml and fill in real values before running tests

# Domain Creation Tests
create_domain:
  test_cases:
    - name: "basic_char_domain"
      enabled: false
      description: "Create a simple CHAR domain"
      params:
        domain_name: "ZZ_TEST_MCP_01"
        description: "Test domain created via MCP"
        package_name: "ZOK_LOCAL"
        transport_request: "<YOUR_TRANSPORT_REQUEST>"  # ⚠️ UPDATE THIS BEFORE TESTING
        datatype: "CHAR"
        length: 50
        decimals: 0
        lowercase: false
        sign_exists: false

# Program Tests
get_program:
  test_cases:
    - name: "standard_program"
      enabled: false
      params:
        program_name: "SAPMV45A"

# Class Tests
get_class:
  test_cases:
    - name: "standard_class"
      enabled: false
      params:
        class_name: "CL_ABAP_TYPEDESCR"

# Function Tests
get_function:
  test_cases:
    - name: "standard_function"
      enabled: false
      params:
        function_name: "RFC_READ_TABLE"
        function_group: "SRFC"

# Table Tests
get_table:
  test_cases:
    - name: "standard_table"
      enabled: false
      params:
        table_name: "MARA"

get_table_contents:
  test_cases:
    - name: "limited_rows"
      enabled: false
      params:
        table_name: "T000"
        max_rows: 10

# Package Tests
get_package:
  test_cases:
    - name: "standard_package"
      enabled: false
      params:
        package_name: "$TMP"

# Search Tests
search_object:
  test_cases:
    - name: "search_tables"
      enabled: false
      params:
        object_name: "MARA*"
        object_type: "TABL"
        maxResults: 10

# SQL Query Tests

# ============================================================================
# CDS UNIT TEST - High-Level Handlers
# ============================================================================

cds_unit_test:
  test_cases:
    - name: "full_workflow"
      enabled: false
      description: "Full workflow test for CDS unit test handlers: Create → Update → Run → Get → Delete"
      params:
        class_name: "<YOUR_CDS_UNIT_TEST_CLASS_NAME>"
        test_class_name: "<YOUR_CDS_TEST_CLASS_NAME>"
        package_name: "<YOUR_PACKAGE_NAME>"
        cds_view_name: "<YOUR_CDS_VIEW_NAME>"
        description: "CDS unit test class"
        # transport_request: "<YOUR_TRANSPORT_REQUEST>"  # Optional for local packages
        class_template: |
          CLASS <YOUR_CDS_UNIT_TEST_CLASS_NAME> DEFINITION
            PUBLIC
            FINAL
            CREATE PUBLIC .

            PUBLIC SECTION.
            PROTECTED SECTION.
            PRIVATE SECTION.
          ENDCLASS.

          CLASS <YOUR_CDS_UNIT_TEST_CLASS_NAME> IMPLEMENTATION.
          ENDCLASS.
        test_class_source: |
          CLASS <YOUR_CDS_TEST_CLASS_NAME> DEFINITION FINAL
            FOR TESTING RISK LEVEL HARMLESS DURATION SHORT.
            PRIVATE SECTION.
              METHODS test_method FOR TESTING.
          ENDCLASS.
          CLASS <YOUR_CDS_TEST_CLASS_NAME> IMPLEMENTATION.
            METHOD test_method.
              cl_abap_unit_assert=>assert_true( abap_true ).
            ENDMETHOD.
          ENDCLASS.
        update_test_class_source: |
          CLASS <YOUR_CDS_TEST_CLASS_NAME> DEFINITION FINAL
            FOR TESTING RISK LEVEL HARMLESS DURATION SHORT.
            PRIVATE SECTION.
              METHODS test_method FOR TESTING.
          ENDCLASS.
          CLASS <YOUR_CDS_TEST_CLASS_NAME> IMPLEMENTATION.
            METHOD test_method.
              cl_abap_unit_assert=>assert_true( abap_true ).
            ENDMETHOD.
          ENDCLASS.
get_sql_query:
  test_cases:
    - name: "simple_select"
      enabled: false
      params:
        sql_query: "SELECT MANDT, MTEXT FROM T000 WHERE MANDT < '100'"
        row_number: 10

# Where Used Tests
get_where_used:
  test_cases:
    - name: "table_usage"
      enabled: false
      params:
        object_name: "MARA"
        object_type: "TABL/DT"
        detailed: false

# Enhancement Tests
get_enhancements:
  test_cases:
    - name: "program_enhancements"
      enabled: false
      params:
        object_name: "SAPMV45A"
        object_type: "PROG/P"

# Object Info Tests
get_object_info:
  test_cases:
    - name: "class_structure"
      enabled: false
      params:
        parent_type: "CLAS/OC"
        parent_name: "CL_ABAP_TYPEDESCR"
        maxDepth: 2
        enrich: true

# ABAP Parser Tests
get_abap_ast:
  test_cases:
    - name: "simple_code"
      enabled: false
      params:
        code: |
          REPORT test.
          DATA: lv_text TYPE string.
          lv_text = 'Hello World'.
          WRITE: / lv_text.

get_abap_semantic_analysis:
  test_cases:
    - name: "with_symbols"
      enabled: false
      params:
        code: |
          REPORT test.
          DATA: lv_count TYPE i,
                lv_name TYPE string.
          lv_count = 42.
          lv_name = 'Test'.

# Runtime Read-Only Handlers (Profiling + Dumps)
runtime_readonly_handlers:
  test_cases:
    - name: "test_runtime_readonly"
      enabled: false
      description: "Runtime profiling and dumps handlers integration tests"
      params:
        # Required: class that supports ADT classrun in your system
        profiled_class_name: "<YOUR_CLASSRUN_CLASS_NAME>"
        # Prefix for temporary class created by profiling test
        profiled_class_prefix: "ZADT_RTCLS"
        # Optional: on-prem only. Skipped on ABAP Cloud.
        profiled_program_name: "<YOUR_EXECUTABLE_PROGRAM_NAME>"
        # Prefix for temporary program created by profiling test (on-prem only)
        profiled_program_prefix: "ZADT_RTPRG"
        # Optional fallback trace id/uri
        trace_id_or_uri: ""
        trace_feed_retries: 6
        trace_feed_retry_delay_ms: 1000
        trace_read_retries: 6
        trace_read_retry_delay_ms: 1500
        # Optional user filter for dumps; empty = all users
        dumps_user: ""
        dumps_read_limit: 5
        # Prefix for temporary class that forces runtime dump (division by zero)
        dump_class_prefix: "ZADT_RTDMP"
        # Retries for dump feed lookup after forced failure
        dump_feed_retries: 8
        dump_feed_retry_delay_ms: 1500
        # How many recent dumps to request per poll when looking for generated dump
        dump_feed_top: 50
        # Dump read view for RuntimeGetDumpById/RuntimeAnalyzeDump: default|summary|formatted
        dump_view: "default"
        # Recommended fallback dump ID to avoid skip when feed is empty
        dump_id: ""

# Environment Configuration
# These values can be overridden by environment variables
environment:
  default_package: "ZOK_LOCAL"
  default_transport: "<YOUR_TRANSPORT_REQUEST>"  # ⚠️ UPDATE THIS BEFORE TESTING
  default_system: "E19"
  default_client: "100"

# Test Execution Settings
test_settings:
  fail_fast: false
  verbose: true
  timeout: 30000
  retry_on_failure: false
  max_retries: 1
  cleanup_after_test: false
