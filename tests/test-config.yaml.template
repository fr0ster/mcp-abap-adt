# Template for MCP ABAP ADT test configuration
# Copy this file to test-config.yaml and fill in real values before running tests

# Domain Creation Tests
create_domain:
  test_cases:
    - name: "basic_char_domain"
      enabled: false
      description: "Create a simple CHAR domain"
      params:
        domain_name: "ZZ_TEST_MCP_01"
        description: "Test domain created via MCP"
        package_name: "ZOK_LOCAL"
        transport_request: "<YOUR_TRANSPORT_REQUEST>"  # ⚠️ UPDATE THIS BEFORE TESTING
        datatype: "CHAR"
        length: 50
        decimals: 0
        lowercase: false
        sign_exists: false

# Data Element Creation Tests
create_data_element:
  test_cases:
    - name: "basic_data_element"
      enabled: false
      description: "Create a simple data element based on domain"
      params:
        data_element_name: "ZZ_E_TEST_MCP_01"
        description: "Test data element created via MCP"
        package_name: "ZOK_LOCAL"
        transport_request: "<YOUR_TRANSPORT_REQUEST>"  # ⚠️ UPDATE THIS BEFORE TESTING
        domain_name: "ZZ_TEST_MCP_01"  # Use domain created by create_domain test
        data_type: "CHAR"
        length: 50
        decimals: 0
        short_label: "ShortLbl"
        medium_label: "Medium Label"
        long_label: "Long Field Label"
        heading_label: "Heading"

# Transport Management Tests
create_transport:
  test_cases:
    - name: "workbench_transport"
      enabled: false
      description: "Create a workbench transport request"
      params:
        transport_type: "workbench"
        description: "Test transport created via MCP"
        target_system: "QAS"  # Update with your target system

get_transport:
  test_cases:
    - name: "existing_transport"
      enabled: false
      description: "Retrieve existing transport information"
      params:
        transport_number: "<YOUR_TRANSPORT_NUMBER>"  # ⚠️ UPDATE WITH REAL TRANSPORT
        include_objects: true
        include_tasks: true

# Program Tests
get_program:
  test_cases:
    - name: "standard_program"
      enabled: false
      params:
        program_name: "SAPMV45A"

# Class Tests
get_class:
  test_cases:
    - name: "standard_class"
      enabled: false
      params:
        class_name: "CL_ABAP_TYPEDESCR"

# Function Tests
get_function:
  test_cases:
    - name: "standard_function"
      enabled: false
      params:
        function_name: "RFC_READ_TABLE"
        function_group: "SRFC"

# Table Tests
get_table:
  test_cases:
    - name: "standard_table"
      enabled: false
      params:
        table_name: "MARA"

get_table_contents:
  test_cases:
    - name: "limited_rows"
      enabled: false
      params:
        table_name: "T000"
        max_rows: 10

# Package Tests
get_package:
  test_cases:
    - name: "standard_package"
      enabled: false
      params:
        package_name: "$TMP"

create_package:
  test_cases:
    - name: "basic_package"
      enabled: false
      description: "Create a basic development package"
      params:
        package_name: "ZOK_TEST_PKG_01"
        description: "Test package created via MCP"
        super_package: "ZOK_PACKAGE"  # Parent package
        package_type: "development"  # or "structure"
        software_component: "HOME"
        transport_layer: "ZE19"  # Update with your transport layer
        transport_request: "<YOUR_TRANSPORT_REQUEST>"  # ⚠️ UPDATE THIS BEFORE TESTING
        application_component: ""  # Optional, e.g., "BC-ABA"

# Search Tests
search_object:
  test_cases:
    - name: "search_tables"
      enabled: false
      params:
        object_name: "MARA*"
        object_type: "TABL"
        maxResults: 10

# SQL Query Tests
get_sql_query:
  test_cases:
    - name: "simple_select"
      enabled: false
      params:
        sql_query: "SELECT MANDT, MTEXT FROM T000 WHERE MANDT < '100'"
        row_number: 10

# Where Used Tests
get_where_used:
  test_cases:
    - name: "table_usage"
      enabled: false
      params:
        object_name: "MARA"
        object_type: "TABL/DT"
        detailed: false

# Enhancement Tests
get_enhancements:
  test_cases:
    - name: "program_enhancements"
      enabled: false
      params:
        object_name: "SAPMV45A"
        object_type: "PROG/P"

# Object Info Tests
get_object_info:
  test_cases:
    - name: "class_structure"
      enabled: false
      params:
        parent_type: "CLAS/OC"
        parent_name: "CL_ABAP_TYPEDESCR"
        maxDepth: 2
        enrich: true

# ABAP Parser Tests
get_abap_ast:
  test_cases:
    - name: "simple_code"
      enabled: false
      params:
        code: |
          REPORT test.
          DATA: lv_text TYPE string.
          lv_text = 'Hello World'.
          WRITE: / lv_text.

get_abap_semantic_analysis:
  test_cases:
    - name: "with_symbols"
      enabled: false
      params:
        code: |
          REPORT test.
          DATA: lv_count TYPE i,
                lv_name TYPE string.
          lv_count = 42.
          lv_name = 'Test'.

# View Creation Tests (Classic SE11 Database View)
create_view:
  view_name: "ZV_TEST_MCP_VIEW_01"
  description: "Test Database View created via MCP ABAP ADT"
  package_name: "ZOK_LOCAL"
  transport_request: "<YOUR_TRANSPORT_REQUEST>"  # ⚠️ UPDATE THIS BEFORE TESTING
  sql_view_name: "ZV_MCP_V01"  # SQL view name (16 chars max)
  base_table: "MARA"
  select_fields:
    - "MATNR"
    - "MTART"
    - "MEINS"
    - "ERSDA"

# CDS View Creation Tests (Modern DDLS with DDL Source)
create_cds:
  cds_name: "Z_I_TEST_MCP_CDS_01"
  description: "Test CDS View created via MCP ABAP ADT"
  package_name: "ZOK_LOCAL"
  transport_request: "<YOUR_TRANSPORT_REQUEST>"  # ⚠️ UPDATE THIS BEFORE TESTING
  ddl_source: |
    @AbapCatalog.viewEnhancementCategory: [#NONE]
    @AccessControl.authorizationCheck: #NOT_REQUIRED
    @EndUserText.label: 'Test CDS View for Materials'
    @Metadata.ignorePropagatedAnnotations: true
    @ObjectModel.usageType:{
      serviceQuality: #X,
      sizeCategory: #S,
      dataClass: #MIXED
    }
    define view Z_I_TEST_MCP_CDS_01
      as select from mara
    {
      key matnr as Material,
          mtart as MaterialType,
          meins as BaseUnitOfMeasure,
          ersda as CreatedOn,
          laeda as LastChanged
    }

# Class Creation Tests
create_class:
  class_name: "ZCL_TEST_MCP_01"
  description: "Test ABAP Class created via MCP ABAP ADT"
  package_name: "ZOK_LOCAL"
  transport_request: "<YOUR_TRANSPORT_REQUEST>"  # ⚠️ UPDATE THIS BEFORE TESTING
  superclass: ""  # Optional: e.g., "CL_ABAP_BEHAVIOR_HANDLER"
  final: false
  abstract: false
  create_protected: false
  source_code: |
    CLASS ZCL_TEST_MCP_01 DEFINITION
      PUBLIC
      FINAL
      CREATE PUBLIC .

      PUBLIC SECTION.
        METHODS: constructor.
      PROTECTED SECTION.
      PRIVATE SECTION.
    ENDCLASS.

    CLASS ZCL_TEST_MCP_01 IMPLEMENTATION.
      METHOD constructor.
        " Initialization logic here
        WRITE: / 'Class instance created'.
      ENDMETHOD.
    ENDCLASS.

# Program Creation Tests
create_program:
  program_name: "Z_TEST_PROGRAM_01"
  description: "Test ABAP Program created via MCP ABAP ADT"
  package_name: "ZOK_LOCAL"
  transport_request: "<YOUR_TRANSPORT_REQUEST>"  # ⚠️ UPDATE THIS BEFORE TESTING
  program_type: "1"  # 1=Executable, I=Include, M=Module Pool, F=Function Group
  application: "*"   # Application area (e.g., 'S' for System, 'M' for MM)
  source_code: |
    *&---------------------------------------------------------------------*
    *& Report Z_TEST_PROGRAM_01
    *& Test ABAP Program created via MCP ABAP ADT
    *&---------------------------------------------------------------------*
    REPORT Z_TEST_PROGRAM_01.

    START-OF-SELECTION.
      WRITE: / 'Program Z_TEST_PROGRAM_01 executed successfully.'.
      WRITE: / 'Created via MCP ABAP ADT API.'.

# Activation Tests
activate_object:
  objects:
    - name: "ZCL_TEST_MCP_01"
      uri: "/sap/bc/adt/oo/classes/zcl_test_mcp_01"
      type: "CLAS/OC"
    - name: "Z_TEST_PROGRAM_01"
      uri: "/sap/bc/adt/programs/programs/z_test_program_01"
      type: "PROG/P"
  preaudit: true

# Update Class Source Tests
update_class_source:
  class_name: "ZCL_TEST_MCP_01"
  activate: true  # Set to false to skip activation (use ActivateObject later)
  source_code: |
    CLASS ZCL_TEST_MCP_01 DEFINITION
      PUBLIC
      FINAL
      CREATE PUBLIC .

      PUBLIC SECTION.
        METHODS: 
          constructor,
          get_message RETURNING VALUE(rv_message) TYPE string.
      PROTECTED SECTION.
      PRIVATE SECTION.
    ENDCLASS.

    CLASS ZCL_TEST_MCP_01 IMPLEMENTATION.
      METHOD constructor.
        " Updated initialization logic
        WRITE: / 'Class instance created - UPDATED'.
      ENDMETHOD.

      METHOD get_message.
        rv_message = 'Updated message from MCP test'.
      ENDMETHOD.
    ENDCLASS.

# Update Program Source Tests
update_program_source:
  program_name: "Z_TEST_PROGRAM_01"
  activate: true  # Set to false to skip activation (use ActivateObject later)
  source_code: |
    *&---------------------------------------------------------------------*
    *& Report Z_TEST_PROGRAM_01
    *& UPDATED Test ABAP Program via MCP ABAP ADT
    *&---------------------------------------------------------------------*
    REPORT Z_TEST_PROGRAM_01.

    START-OF-SELECTION.
      WRITE: / 'Program Z_TEST_PROGRAM_01 executed successfully - UPDATED'.
      WRITE: / 'Updated via MCP ABAP ADT API.'.
      WRITE: / 'Modification date:', sy-datum.

# Update View Source Tests
update_view_source:
  view_name: "ZOK_R_TEST_0002"
  activate: true  # Set to false to skip activation (use ActivateObject later)
  ddl_source: |
    @AbapCatalog.sqlViewName: 'ZV_TEST_SQL'
    @AbapCatalog.compiler.compareFilter: true
    @AccessControl.authorizationCheck: #NOT_REQUIRED
    @EndUserText.label: 'Updated Test View via MCP'
    define view ZOK_R_TEST_0002
      as select from mara
    {
      key matnr as Material,
          mtart as MaterialType,
          matkl as MaterialGroup,
          meins as BaseUnit,
          ersda as CreatedOn,
          laeda as LastChanged
    }

# Environment Configuration
# These values can be overridden by environment variables
environment:
  default_package: "ZOK_LOCAL"
  default_transport: "<YOUR_TRANSPORT_REQUEST>"  # ⚠️ UPDATE THIS BEFORE TESTING
  default_system: "E19"
  default_client: "100"

# Interface Creation Tests
create_interface:
  test_cases:
    - name: "basic_interface"
      enabled: false
      description: "Create a simple ABAP interface"
      params:
        interface_name: "ZIF_TEST_MCP_01"
        description: "Test interface created via MCP"
        package_name: "$TMP"
        source_code: |
          INTERFACE zif_test_mcp_01
            PUBLIC.
            
            METHODS test_method
              IMPORTING
                iv_param TYPE string
              RETURNING
                VALUE(rv_result) TYPE string.
                
          ENDINTERFACE.

# Object Deletion Tests
delete_object:
  test_cases:
    - name: "delete_test_interface"
      enabled: false
      description: "Test object deletion with transport"
      params:
        test_interface_name: "ZIF_TEST_DELETE_01"
        transport_request: "<YOUR_TRANSPORT_REQUEST>"  # ⚠️ UPDATE THIS BEFORE TESTING
        package_name: "$TMP"

# Test Execution Settings
test_settings:
  fail_fast: false
  verbose: true
  timeout: 30000
  retry_on_failure: false
  max_retries: 1
  cleanup_after_test: false
